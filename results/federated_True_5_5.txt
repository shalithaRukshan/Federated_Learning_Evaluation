
cf matrix for slice :5
[[7412   21   22  201   49]
 [  97 5216    0   24    1]
 [   2    0    8    1    0]
 [   8    0    2  378    0]
 [  33    0    0   19 1355]]
cf matrix for slice :5
[[7014  135   49  427   80]
 [   2 5333    3    0    0]
 [   1    0    8    2    0]
 [ 138    9   48  137   56]
 [  14    1   10   10 1372]]
cf matrix for slice :5
[[6483   47   86 1023   66]
 [  38 5269    0   28    3]
 [   2    0    6    3    0]
 [ 131    2   37  213    5]
 [  22    1    1   19 1364]]
cf matrix for slice :5
[[7010   78   54  517   46]
 [  65 5270    0    3    0]
 [   2    0    5    4    0]
 [ 133    7   13  231    4]
 [  17    4    3   22 1361]]
cf matrix for slice :5
[[6627   91   64  830   93]
 [  45 5234    0   32   27]
 [   7    0    1    3    0]
 [  64   79    1  239    5]
 [  59    2    3   50 1293]]
Centralized Mean train accuracy: 0.9412397042716577
Centralized Mean test accuracy: 0.9097481311872854
before training main model
cf matrix for slice :5
[[   0 7705    0    0    0]
 [   0 5338    0    0    0]
 [   0   11    0    0    0]
 [   0  388    0    0    0]
 [   0 1407    0    0    0]]
after training main model
cf matrix for slice :5
[[7132  124   44  302  103]
 [  73 5242    3    0   20]
 [   2    0    7    2    0]
 [  46   22   65  251    4]
 [  38    2   10    7 1350]]
Before training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.9624             0.3595
1  sample 1           0.9283             0.3595
2  sample 2           0.9096             0.3595
3  sample 3           0.9134             0.3595
4  sample 4           0.9078             0.3595
After training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.9624             0.9416
1  sample 1           0.9283             0.9416
2  sample 2           0.9096             0.9416
3  sample 3           0.9134             0.9416
4  sample 4           0.9078             0.9416