
cf matrix for slice :4
[[6835   39   31  755   45]
 [  20 5294    3   20    1]
 [   1    0    8    2    0]
 [   4    2   13  369    0]
 [  15    0    9   16 1367]]
cf matrix for slice :4
[[7172   43   38  422   30]
 [  37 5298    3    0    0]
 [   0    0    8    3    0]
 [ 145    4   28  209    2]
 [  14    1    6   21 1365]]
cf matrix for slice :4
[[6643  107   20  900   35]
 [   8 5321    0    9    0]
 [   1    0    5    5    0]
 [ 130   21    1  234    2]
 [  23    1    0   24 1359]]
cf matrix for slice :4
[[6713  111   78  693  110]
 [  15 5282    0   34    7]
 [   6    0    1    4    0]
 [ 104   42    3  236    3]
 [  31    4    5   27 1340]]
Centralized Mean train accuracy: 0.9371562265674566
Centralized Mean test accuracy: 0.9128274631288302
before training main model
cf matrix for slice :4
[[   0    0    0 7705    0]
 [   0    0    0 5338    0]
 [   0    0    0   11    0]
 [   0    0    0  388    0]
 [   0    0    0 1407    0]]
after training main model
cf matrix for slice :4
[[7315  104   34  193   59]
 [  66 5264    4    0    4]
 [   4    0    7    0    0]
 [  64   19   20  279    6]
 [  37    1   10    5 1354]]
Before training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.9554             0.0261
1  sample 1           0.9386             0.0261
2  sample 2           0.9494             0.0261
3  sample 3           0.9237             0.0261
After training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.9554             0.9576
1  sample 1           0.9386             0.9576
2  sample 2           0.9494             0.9576
3  sample 3           0.9237             0.9576