
cf matrix for slice :4
[[7471   66   49   90   29]
 [  16 5319    3    0    0]
 [   1    0   10    0    0]
 [  19    3   15  351    0]
 [  28    2    6    8 1363]]
cf matrix for slice :4
[[6727   35   62  852   29]
 [  37 5257    4   37    3]
 [   0    0    8    3    0]
 [ 128    2   43  212    3]
 [  25    0    8   16 1358]]
cf matrix for slice :4
[[6969   43   21  590   82]
 [  29 5283    0   25    1]
 [   3    0    4    4    0]
 [ 165    5    4  182   32]
 [  16    1    0   15 1375]]
cf matrix for slice :4
[[6824   56   96  614  115]
 [  39 5247    0   25   27]
 [   6    0    1    4    0]
 [ 100   46    4  235    3]
 [  20    0    5   42 1340]]
Centralized Mean train accuracy: 0.9373269596816056
Centralized Mean test accuracy: 0.9168799245740453
before training main model
cf matrix for slice :4
[[   0    1    0    0 7704]
 [   0   28    0    0 5310]
 [   0    0    0    0   11]
 [   0    0    0    0  388]
 [   0    0    0    0 1407]]
after training main model
cf matrix for slice :4
[[7186   96   41  281  101]
 [  84 5240    3    0   11]
 [   3    0    8    0    0]
 [  97    7    5  248   31]
 [  29    3    3    8 1364]]
Before training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.9461             0.0966
1  sample 1           0.9221             0.0966
2  sample 2           0.9060             0.0966
3  sample 3           0.8994             0.0966
After training federated
     sample  local_ind_model  merged_main_model
0  sample 0           0.9461             0.9459
1  sample 1           0.9221             0.9459
2  sample 2           0.9060             0.9459
3  sample 3           0.8994             0.9459